{
  "version": 4,
  "terraform_version": "1.11.4",
  "serial": 97,
  "lineage": "5012104a-ee05-7409-00b3-dee5c682aeed",
  "outputs": {},
  "resources": [
    {
      "module": "module.ec2",
      "mode": "managed",
      "type": "aws_launch_template",
      "name": "automation_template",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ec2:us-west-1:779846783544:launch-template/lt-0b08e2d685aa291af",
            "block_device_mappings": [],
            "capacity_reservation_specification": [],
            "cpu_options": [],
            "credit_specification": [],
            "default_version": 1,
            "description": "",
            "disable_api_stop": false,
            "disable_api_termination": false,
            "ebs_optimized": "",
            "elastic_gpu_specifications": [],
            "elastic_inference_accelerator": [],
            "enclave_options": [],
            "hibernation_options": [],
            "iam_instance_profile": [],
            "id": "lt-0b08e2d685aa291af",
            "image_id": "ami-04f7a54071e74f488",
            "instance_initiated_shutdown_behavior": "",
            "instance_market_options": [],
            "instance_requirements": [],
            "instance_type": "t3.medium",
            "kernel_id": "",
            "key_name": "automation-key-pair",
            "latest_version": 1,
            "license_specification": [],
            "maintenance_options": [],
            "metadata_options": [],
            "monitoring": [],
            "name": "automation-robot-template",
            "name_prefix": "",
            "network_interfaces": [
              {
                "associate_carrier_ip_address": "",
                "associate_public_ip_address": "true",
                "connection_tracking_specification": [],
                "delete_on_termination": "",
                "description": "",
                "device_index": 0,
                "ena_srd_specification": [],
                "interface_type": "",
                "ipv4_address_count": 0,
                "ipv4_addresses": null,
                "ipv4_prefix_count": 0,
                "ipv4_prefixes": null,
                "ipv6_address_count": 0,
                "ipv6_addresses": null,
                "ipv6_prefix_count": 0,
                "ipv6_prefixes": null,
                "network_card_index": 0,
                "network_interface_id": "",
                "primary_ipv6": "",
                "private_ip_address": "",
                "security_groups": [
                  "sg-04f36fb338a642b2a"
                ],
                "subnet_id": ""
              }
            ],
            "placement": [],
            "private_dns_name_options": [],
            "ram_disk_id": "",
            "security_group_names": null,
            "tag_specifications": [
              {
                "resource_type": "instance",
                "tags": {
                  "Name": "automation-robot-instance"
                }
              }
            ],
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "update_default_version": null,
            "user_data": "IyEvYmluL2Jhc2gKIyBFQzIgVWJ1bnR1IHVzZXJkYXRhIHNjcmlwdCBmb3IgQXV0b21hdGlvbi1yb2JvdAojIFRoaXMgc2NyaXB0IHJ1bnMgb24gaW5zdGFuY2UgZmlyc3QgYm9vdApzdWRvIHN1CmFwdCB1cGRhdGUKYXB0IHVwZ3JhZGUgLXkKYXB0IGluc3RhbGwgLXkgZ2l0IApnaXQgY2xvbmUgaHR0cHM6Ly9naXRodWIuY29tL2FkYXZpZGFyZXZhbG8vQXV0b21hdGlvbi1yb2JvdC5naXQgJEFQUF9ESVIKY2QgQXV0b21hdGlvbi1yb2JvdC8KCnN1ZG8gYXB0IGluc3RhbGwgdjRsMmxvb3BiYWNrLWRrbXMgdjRsMmxvb3BiYWNrLXV0aWxzIGZmbXBlZyAteQoKc3VkbyBtb2Rwcm9iZSAtciB2NGwybG9vcGJhY2sKc3VkbyBtb2Rwcm9iZSB2NGwybG9vcGJhY2sgdmlkZW9fbnI9MiBjYXJkX2xhYmVsPSJGYWtlQ2FtIiBleGNsdXNpdmVfY2Fwcz0xCgpzdWRvIG1vZHByb2JlIHY0bDJsb29wYmFjayBcCiAgZXhjbHVzaXZlX2NhcHM9MSBcCiAgbWF4X3dpZHRoPTE5MjAgbWF4X2hlaWdodD0xMDgwIFwKICB2aWRlb19ucj0yIFwKICBjYXJkX2xhYmVsPSJGYWtlQ2FtIiAgCgojIEVqZWN1dGFyIGZmbXBlZyBlbiBzZWd1bmRvIHBsYW5vIHBhcmEgbWFudGVuZXIgZWwgdmlkZW8gZW4gbG9vcApub2h1cCBmZm1wZWcgLXJlIC1zdHJlYW1fbG9vcCAtMSAtaSAiLi9wdWJsaWMvdmlkZW8ubXA0IiBcCiAgLXZjb2RlYyByYXd2aWRlbyAtcGl4X2ZtdCB5dXY0MjBwIFwKICAtZiB2NGwyIC9kZXYvdmlkZW8yID4gL2Rldi9udWxsIDI+JjEgJgoKIyBFc3BlcmFyIHVuIG1vbWVudG8gcGFyYSBhc2VndXJhcnNlIGRlIHF1ZSBmZm1wZWcgaW5pY2nDsyBjb3JyZWN0YW1lbnRlCnNsZWVwIDQKZWNobyAiV2ViY2FtIHZpcnR1YWwgY29uIHZpZGVvIGVuIGxvb3AgaW5pY2lhZGEgZW4gc2VndW5kbyBwbGFubyIKCnN1ZG8gYXB0IGluc3RhbGwgLXkgbm9kZWpzIG5wbSAKc3VkbyBucG0gaQpzdWRvIG5weCBwdXBwZXRlZXIgYnJvd3NlcnMgaW5zdGFsbCBjaHJvbWUgLXkKIyBSZXRyeSBtZWNoYW5pc20gZm9yIG5wbSBydW4gc3RhcnQgLSB1cCB0byAzIGF0dGVtcHRzCk1BWF9SRVRSSUVTPTMKUkVUUllfQ09VTlQ9MApTVUNDRVNTPWZhbHNlCgplY2hvICJBdHRlbXB0aW5nIHRvIHN0YXJ0IHRoZSBhcHBsaWNhdGlvbiAoYXR0ZW1wdCAxIG9mICRNQVhfUkVUUklFUykiCndoaWxlIFsgJFJFVFJZX0NPVU5UIC1sdCAkTUFYX1JFVFJJRVMgXSAmJiBbICRTVUNDRVNTID0gZmFsc2UgXTsgZG8KICBzdWRvIG5wbSBydW4gc3RhcnQKICBpZiBbICQ/IC1lcSAwIF07IHRoZW4KICAgIGVjaG8gIkFwcGxpY2F0aW9uIHN0YXJ0ZWQgc3VjY2Vzc2Z1bGx5IgogICAgU1VDQ0VTUz10cnVlCiAgZWxzZQogICAgUkVUUllfQ09VTlQ9JCgoUkVUUllfQ09VTlQrMSkpCiAgICBpZiBbICRSRVRSWV9DT1VOVCAtbHQgJE1BWF9SRVRSSUVTIF07IHRoZW4KICAgICAgZWNobyAiU3RhcnQgZmFpbGVkLiBSZXRyeWluZyAoYXR0ZW1wdCAkKChSRVRSWV9DT1VOVCsxKSkgb2YgJE1BWF9SRVRSSUVTKS4uLiIKICAgICAgc2xlZXAgNQogICAgZWxzZQogICAgICBlY2hvICJGYWlsZWQgdG8gc3RhcnQgYXBwbGljYXRpb24gYWZ0ZXIgJE1BWF9SRVRSSUVTIGF0dGVtcHRzIgogICAgZmkKICBmaQpkb25lCg==",
            "vpc_security_group_ids": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.ec2.aws_security_group.automation_sg"
          ]
        }
      ]
    },
    {
      "module": "module.ec2",
      "mode": "managed",
      "type": "aws_security_group",
      "name": "automation_sg",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:us-west-1:779846783544:security-group/sg-04f36fb338a642b2a",
            "description": "Security group for Automation Robot instances",
            "egress": [
              {
                "cidr_blocks": [
                  "0.0.0.0/0"
                ],
                "description": "Allow all outbound traffic",
                "from_port": 0,
                "ipv6_cidr_blocks": [],
                "prefix_list_ids": [],
                "protocol": "-1",
                "security_groups": [],
                "self": false,
                "to_port": 0
              }
            ],
            "id": "sg-04f36fb338a642b2a",
            "ingress": [
              {
                "cidr_blocks": [
                  "0.0.0.0/0"
                ],
                "description": "SSH access",
                "from_port": 22,
                "ipv6_cidr_blocks": [],
                "prefix_list_ids": [],
                "protocol": "tcp",
                "security_groups": [],
                "self": false,
                "to_port": 22
              }
            ],
            "name": "automation-robot-sg",
            "name_prefix": "",
            "owner_id": "779846783544",
            "revoke_rules_on_delete": false,
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "timeouts": null,
            "vpc_id": "vpc-03d15d69f712a1d11"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6OTAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "start_ec2_rule",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "schedule-0",
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-west-1:779846783544:rule/automation-robot-start-schedule-0",
            "description": "Start EC2 instance at 20:15 on Thursday",
            "event_bus_name": "default",
            "event_pattern": null,
            "force_destroy": false,
            "id": "automation-robot-start-schedule-0",
            "is_enabled": true,
            "name": "automation-robot-start-schedule-0",
            "name_prefix": "",
            "role_arn": "",
            "schedule_expression": "cron(15 20 ? * Thu *)",
            "state": "ENABLED",
            "tags": {
              "Name": "automation-robot-start-schedule-0"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "automation-robot-start-schedule-0",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        },
        {
          "index_key": "schedule-1",
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-west-1:779846783544:rule/automation-robot-start-schedule-1",
            "description": "Start EC2 instance at 20:10 on Wednesday",
            "event_bus_name": "default",
            "event_pattern": null,
            "force_destroy": false,
            "id": "automation-robot-start-schedule-1",
            "is_enabled": true,
            "name": "automation-robot-start-schedule-1",
            "name_prefix": "",
            "role_arn": "",
            "schedule_expression": "cron(10 20 ? * Wed *)",
            "state": "ENABLED",
            "tags": {
              "Name": "automation-robot-start-schedule-1"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "automation-robot-start-schedule-1",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        },
        {
          "index_key": "schedule-2",
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-west-1:779846783544:rule/automation-robot-start-schedule-2",
            "description": "Start EC2 instance at 10:20 on Wednesday",
            "event_bus_name": "default",
            "event_pattern": null,
            "force_destroy": false,
            "id": "automation-robot-start-schedule-2",
            "is_enabled": true,
            "name": "automation-robot-start-schedule-2",
            "name_prefix": "",
            "role_arn": "",
            "schedule_expression": "cron(20 10 ? * Wed *)",
            "state": "ENABLED",
            "tags": {
              "Name": "automation-robot-start-schedule-2"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "automation-robot-start-schedule-2",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_cloudwatch_event_rule",
      "name": "stop_ec2_rule",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "schedule-0",
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-west-1:779846783544:rule/automation-robot-stop-schedule-0",
            "description": "Stop EC2 instance 50 minutes after starting on Thursday",
            "event_bus_name": "default",
            "event_pattern": null,
            "force_destroy": false,
            "id": "automation-robot-stop-schedule-0",
            "is_enabled": true,
            "name": "automation-robot-stop-schedule-0",
            "name_prefix": "",
            "role_arn": "",
            "schedule_expression": "cron(5 21.083333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333334 ? * Thu *)",
            "state": "ENABLED",
            "tags": {
              "Name": "automation-robot-stop-schedule-0"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "automation-robot-stop-schedule-0",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        },
        {
          "index_key": "schedule-1",
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-west-1:779846783544:rule/automation-robot-stop-schedule-1",
            "description": "Stop EC2 instance 50 minutes after starting on Wednesday",
            "event_bus_name": "default",
            "event_pattern": null,
            "force_destroy": false,
            "id": "automation-robot-stop-schedule-1",
            "is_enabled": true,
            "name": "automation-robot-stop-schedule-1",
            "name_prefix": "",
            "role_arn": "",
            "schedule_expression": "cron(0 21 ? * Wed *)",
            "state": "ENABLED",
            "tags": {
              "Name": "automation-robot-stop-schedule-1"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "automation-robot-stop-schedule-1",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        },
        {
          "index_key": "schedule-2",
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:events:us-west-1:779846783544:rule/automation-robot-stop-schedule-2",
            "description": "Stop EC2 instance 50 minutes after starting on Wednesday",
            "event_bus_name": "default",
            "event_pattern": null,
            "force_destroy": false,
            "id": "automation-robot-stop-schedule-2",
            "is_enabled": true,
            "name": "automation-robot-stop-schedule-2",
            "name_prefix": "",
            "role_arn": "",
            "schedule_expression": "cron(10 11.166666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667 ? * Wed *)",
            "state": "ENABLED",
            "tags": {
              "Name": "automation-robot-stop-schedule-2"
            },
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Name": "automation-robot-stop-schedule-2",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "start_ec2_target",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "schedule-0",
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "automation-robot-start-schedule-0-automation-robot-start-target-schedule-0",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "retry_policy": [],
            "role_arn": "",
            "rule": "automation-robot-start-schedule-0",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "automation-robot-start-target-schedule-0"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_cloudwatch_event_rule.start_ec2_rule",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        },
        {
          "index_key": "schedule-1",
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "automation-robot-start-schedule-1-automation-robot-start-target-schedule-1",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "retry_policy": [],
            "role_arn": "",
            "rule": "automation-robot-start-schedule-1",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "automation-robot-start-target-schedule-1"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_cloudwatch_event_rule.start_ec2_rule",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        },
        {
          "index_key": "schedule-2",
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "automation-robot-start-schedule-2-automation-robot-start-target-schedule-2",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "retry_policy": [],
            "role_arn": "",
            "rule": "automation-robot-start-schedule-2",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "automation-robot-start-target-schedule-2"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_cloudwatch_event_rule.start_ec2_rule",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_cloudwatch_event_target",
      "name": "step_function_target",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "schedule-0",
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-0",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "automation-robot-start-schedule-0-automation-robot-step-function-target-schedule-0",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "retry_policy": [],
            "role_arn": "arn:aws:iam::779846783544:role/automation-robot-events-role",
            "rule": "automation-robot-start-schedule-0",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "automation-robot-step-function-target-schedule-0"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_cloudwatch_event_rule.start_ec2_rule",
            "module.eventbridge.aws_iam_role.events_role",
            "module.eventbridge.aws_iam_role.step_function_role",
            "module.eventbridge.aws_sfn_state_machine.ec2_lifecycle",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.aws_lambda_function.stop_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        },
        {
          "index_key": "schedule-1",
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-1",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "automation-robot-start-schedule-1-automation-robot-step-function-target-schedule-1",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "retry_policy": [],
            "role_arn": "arn:aws:iam::779846783544:role/automation-robot-events-role",
            "rule": "automation-robot-start-schedule-1",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "automation-robot-step-function-target-schedule-1"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_cloudwatch_event_rule.start_ec2_rule",
            "module.eventbridge.aws_iam_role.events_role",
            "module.eventbridge.aws_iam_role.step_function_role",
            "module.eventbridge.aws_sfn_state_machine.ec2_lifecycle",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.aws_lambda_function.stop_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        },
        {
          "index_key": "schedule-2",
          "schema_version": 1,
          "attributes": {
            "appsync_target": [],
            "arn": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-2",
            "batch_target": [],
            "dead_letter_config": [],
            "ecs_target": [],
            "event_bus_name": "default",
            "force_destroy": false,
            "http_target": [],
            "id": "automation-robot-start-schedule-2-automation-robot-step-function-target-schedule-2",
            "input": "",
            "input_path": "",
            "input_transformer": [],
            "kinesis_target": [],
            "redshift_target": [],
            "retry_policy": [],
            "role_arn": "arn:aws:iam::779846783544:role/automation-robot-events-role",
            "rule": "automation-robot-start-schedule-2",
            "run_command_targets": [],
            "sagemaker_pipeline_target": [],
            "sqs_target": [],
            "target_id": "automation-robot-step-function-target-schedule-2"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_cloudwatch_event_rule.start_ec2_rule",
            "module.eventbridge.aws_iam_role.events_role",
            "module.eventbridge.aws_iam_role.step_function_role",
            "module.eventbridge.aws_sfn_state_machine.ec2_lifecycle",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.aws_lambda_function.stop_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "events_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::779846783544:policy/automation-robot-events-policy",
            "attachment_count": 0,
            "description": "Policy to allow EventBridge to start Step Functions",
            "id": "arn:aws:iam::779846783544:policy/automation-robot-events-policy",
            "name": "automation-robot-events-policy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"states:StartExecution\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPA3LET5SI4IFV5CFEFS",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "step_function_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::779846783544:policy/automation-robot-step-function-policy",
            "attachment_count": 0,
            "description": "Policy to allow Step Functions to invoke Lambda",
            "id": "arn:aws:iam::779846783544:policy/automation-robot-step-function-policy",
            "name": "automation-robot-step-function-policy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"lambda:InvokeFunction\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPA3LET5SI4E5JUNFS4Q",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "events_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::779846783544:role/automation-robot-events-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"events.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-05-07T22:11:55Z",
            "description": "",
            "force_detach_policies": false,
            "id": "automation-robot-events-role",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "automation-robot-events-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "unique_id": "AROA3LET5SI4CPXG6GYSS"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "step_function_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::779846783544:role/automation-robot-step-function-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"states.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-05-07T22:11:55Z",
            "description": "",
            "force_detach_policies": false,
            "id": "automation-robot-step-function-role",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "automation-robot-step-function-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "unique_id": "AROA3LET5SI4KPXUMMJ6M"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "events_attachment",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "automation-robot-events-role-20250507221156099300000001",
            "policy_arn": "arn:aws:iam::779846783544:policy/automation-robot-events-policy",
            "role": "automation-robot-events-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.eventbridge.aws_iam_policy.events_policy",
            "module.eventbridge.aws_iam_role.events_role"
          ]
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "step_function_attachment",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "automation-robot-step-function-role-20250507221156107100000002",
            "policy_arn": "arn:aws:iam::779846783544:policy/automation-robot-step-function-policy",
            "role": "automation-robot-step-function-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.eventbridge.aws_iam_policy.step_function_policy",
            "module.eventbridge.aws_iam_role.step_function_role"
          ]
        }
      ]
    },
    {
      "module": "module.eventbridge",
      "mode": "managed",
      "type": "aws_sfn_state_machine",
      "name": "ec2_lifecycle",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "schedule-0",
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-0",
            "creation_date": "2025-05-07T22:12:16Z",
            "definition": "{\n  \"Comment\": \"State machine to manage EC2 instance lifecycle\",\n  \"StartAt\": \"StartEC2Instance\",\n  \"States\": {\n    \"StartEC2Instance\": {\n      \"Type\": \"Task\",\n      \"Resource\": \"arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2\",\n      \"Next\": \"Wait\"\n    },\n    \"Wait\": {\n      \"Type\": \"Wait\",\n      \"Seconds\": 3000,\n      \"Next\": \"StopEC2Instance\"\n    },\n    \"StopEC2Instance\": {\n      \"Type\": \"Task\",\n      \"Resource\": \"arn:aws:lambda:us-west-1:779846783544:function:automation-robot-stop-ec2\",\n      \"End\": true\n    }\n  }\n}\n",
            "description": "",
            "encryption_configuration": [
              {
                "kms_data_key_reuse_period_seconds": 0,
                "kms_key_id": "",
                "type": "AWS_OWNED_KEY"
              }
            ],
            "id": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-0",
            "logging_configuration": [
              {
                "include_execution_data": false,
                "level": "OFF",
                "log_destination": ""
              }
            ],
            "name": "automation-robot-lifecycle-schedule-0",
            "name_prefix": "",
            "publish": false,
            "revision_id": "",
            "role_arn": "arn:aws:iam::779846783544:role/automation-robot-step-function-role",
            "state_machine_version_arn": "",
            "status": "ACTIVE",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "timeouts": null,
            "tracing_configuration": [
              {
                "enabled": false
              }
            ],
            "type": "STANDARD",
            "version_description": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_iam_role.step_function_role",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.aws_lambda_function.stop_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        },
        {
          "index_key": "schedule-1",
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-1",
            "creation_date": "2025-05-07T22:12:16Z",
            "definition": "{\n  \"Comment\": \"State machine to manage EC2 instance lifecycle\",\n  \"StartAt\": \"StartEC2Instance\",\n  \"States\": {\n    \"StartEC2Instance\": {\n      \"Type\": \"Task\",\n      \"Resource\": \"arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2\",\n      \"Next\": \"Wait\"\n    },\n    \"Wait\": {\n      \"Type\": \"Wait\",\n      \"Seconds\": 3000,\n      \"Next\": \"StopEC2Instance\"\n    },\n    \"StopEC2Instance\": {\n      \"Type\": \"Task\",\n      \"Resource\": \"arn:aws:lambda:us-west-1:779846783544:function:automation-robot-stop-ec2\",\n      \"End\": true\n    }\n  }\n}\n",
            "description": "",
            "encryption_configuration": [
              {
                "kms_data_key_reuse_period_seconds": 0,
                "kms_key_id": "",
                "type": "AWS_OWNED_KEY"
              }
            ],
            "id": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-1",
            "logging_configuration": [
              {
                "include_execution_data": false,
                "level": "OFF",
                "log_destination": ""
              }
            ],
            "name": "automation-robot-lifecycle-schedule-1",
            "name_prefix": "",
            "publish": false,
            "revision_id": "",
            "role_arn": "arn:aws:iam::779846783544:role/automation-robot-step-function-role",
            "state_machine_version_arn": "",
            "status": "ACTIVE",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "timeouts": null,
            "tracing_configuration": [
              {
                "enabled": false
              }
            ],
            "type": "STANDARD",
            "version_description": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_iam_role.step_function_role",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.aws_lambda_function.stop_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        },
        {
          "index_key": "schedule-2",
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-2",
            "creation_date": "2025-05-07T22:12:16Z",
            "definition": "{\n  \"Comment\": \"State machine to manage EC2 instance lifecycle\",\n  \"StartAt\": \"StartEC2Instance\",\n  \"States\": {\n    \"StartEC2Instance\": {\n      \"Type\": \"Task\",\n      \"Resource\": \"arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2\",\n      \"Next\": \"Wait\"\n    },\n    \"Wait\": {\n      \"Type\": \"Wait\",\n      \"Seconds\": 3000,\n      \"Next\": \"StopEC2Instance\"\n    },\n    \"StopEC2Instance\": {\n      \"Type\": \"Task\",\n      \"Resource\": \"arn:aws:lambda:us-west-1:779846783544:function:automation-robot-stop-ec2\",\n      \"End\": true\n    }\n  }\n}\n",
            "description": "",
            "encryption_configuration": [
              {
                "kms_data_key_reuse_period_seconds": 0,
                "kms_key_id": "",
                "type": "AWS_OWNED_KEY"
              }
            ],
            "id": "arn:aws:states:us-west-1:779846783544:stateMachine:automation-robot-lifecycle-schedule-2",
            "logging_configuration": [
              {
                "include_execution_data": false,
                "level": "OFF",
                "log_destination": ""
              }
            ],
            "name": "automation-robot-lifecycle-schedule-2",
            "name_prefix": "",
            "publish": false,
            "revision_id": "",
            "role_arn": "arn:aws:iam::779846783544:role/automation-robot-step-function-role",
            "state_machine_version_arn": "",
            "status": "ACTIVE",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "timeouts": null,
            "tracing_configuration": [
              {
                "enabled": false
              }
            ],
            "type": "STANDARD",
            "version_description": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.eventbridge.aws_iam_role.step_function_role",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.aws_lambda_function.start_ec2",
            "module.lambda.aws_lambda_function.stop_ec2",
            "module.lambda.data.archive_file.lambda_code"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "lambda_ec2_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::779846783544:policy/automation-robot-lambda-ec2-policy",
            "attachment_count": 0,
            "description": "Policy to allow Lambda to manage EC2 instances",
            "id": "arn:aws:iam::779846783544:policy/automation-robot-lambda-ec2-policy",
            "name": "automation-robot-lambda-ec2-policy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"ec2:RunInstances\",\"ec2:TerminateInstances\",\"ec2:DescribeInstances\",\"ec2:DescribeLaunchTemplates\",\"ec2:DescribeLaunchTemplateVersions\",\"ec2:CreateTags\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:*:*:*\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPA3LET5SI4GAZ55KTWZ",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::779846783544:role/automation-robot-lambda-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-05-07T22:11:55Z",
            "description": "",
            "force_detach_policies": false,
            "id": "automation-robot-lambda-role",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "automation-robot-lambda-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "unique_id": "AROA3LET5SI4NWNTVREG2"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "lambda_ec2_attachment",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "automation-robot-lambda-role-20250507221156123000000003",
            "policy_arn": "arn:aws:iam::779846783544:policy/automation-robot-lambda-ec2-policy",
            "role": "automation-robot-lambda-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role"
          ]
        }
      ]
    },
    {
      "module": "module.lambda",
      "mode": "data",
      "type": "archive_file",
      "name": "lambda_code",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "c50d33d3dec5bb335c1d20fec768ca285af53d1f",
            "output_base64sha256": "jd4B7QX7h5QWNlMjDBkLsA9rntJuZISZFF7ubXvg8gM=",
            "output_base64sha512": "lEzFFPmHpC2KuTogennqJsyWyQzt+3rV7FP3s3ppnbEQJuRzCm9iV5YgjBcVQAIYK4utHPstr9lIZAintSiXig==",
            "output_file_mode": null,
            "output_md5": "efd970f8eb188937f527b2669ce4f029",
            "output_path": "modules/lambda/lambda_function.zip",
            "output_sha": "c50d33d3dec5bb335c1d20fec768ca285af53d1f",
            "output_sha256": "8dde01ed05fb8794163653230c190bb00f6b9ed26e648499145eee6d7be0f203",
            "output_sha512": "944cc514f987a42d8ab93a207a79ea26cc96c90cedfb7ad5ec53f7b37a699db11026e4730a6f625796208c17154002182b8bad1cfb2dafd9486408a7b528978a",
            "output_size": 761,
            "source": [
              {
                "content": "exports.startInstance = async (event) =\u003e {\n  const AWS = require('aws-sdk');\n  const ec2 = new AWS.EC2();\n        \n  console.log('Starting EC2 instance');\n        \n  // Get launch template ID from environment variable\n  const launchTemplateId = process.env.LAUNCH_TEMPLATE_ID || '';\n        \n  if (!launchTemplateId) {\n    throw new Error('Launch template ID not provided');\n  }\n        \n  try {\n    // Launch a new instance using the template\n    const params = {\n      LaunchTemplate: {\n        LaunchTemplateId: launchTemplateId\n      },\n      MaxCount: 1,\n      MinCount: 1\n    };\n          \n    const result = await ec2.runInstances(params).promise();\n          \n    const instanceId = result.Instances[0].InstanceId;\n    console.log(`Successfully started instance: ${instanceId}`);\n          \n    // Add instance ID to event for use by subsequent rules\n    return {\n      ...event,\n      instanceId: instanceId\n    };\n  } catch (error) {\n    console.error('Error starting instance:', error);\n    throw error;\n  }\n};\n      \nexports.terminateInstance = async (event) =\u003e {\n  const AWS = require('aws-sdk');\n  const ec2 = new AWS.EC2();\n        \n  console.log('Terminating EC2 instance');\n        \n  // Get instance ID from the event\n  const instanceId = event.instanceId;\n        \n  if (!instanceId) {\n    throw new Error('Instance ID not provided in event');\n  }\n        \n  try {\n    // Terminate the instance\n    const params = {\n      InstanceIds: [instanceId]\n    };\n          \n    await ec2.terminateInstances(params).promise();\n          \n    console.log(`Successfully terminated instance: ${instanceId}`);\n    return {\n      statusCode: 200,\n      body: JSON.stringify(`Instance ${instanceId} terminated successfully`)\n    };\n  } catch (error) {\n    console.error('Error terminating instance:', error);\n    throw error;\n  }\n};\n",
                "filename": "index.js"
              }
            ],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lambda",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "start_ec2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2",
            "code_sha256": "jd4B7QX7h5QWNlMjDBkLsA9rntJuZISZFF7ubXvg8gM=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "LAUNCH_TEMPLATE_ID": "lt-0b08e2d685aa291af"
                }
              }
            ],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "modules/lambda/lambda_function.zip",
            "function_name": "automation-robot-start-ec2",
            "handler": "index.startInstance",
            "id": "automation-robot-start-ec2",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-05-07T22:12:09.786+0000",
            "layers": null,
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/automation-robot-start-ec2",
                "system_log_level": ""
              }
            ],
            "memory_size": 128,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:779846783544:function:automation-robot-start-ec2:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::779846783544:role/automation-robot-lambda-role",
            "runtime": "nodejs16.x",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "jd4B7QX7h5QWNlMjDBkLsA9rntJuZISZFF7ubXvg8gM=",
            "source_code_size": 761,
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "timeout": 30,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.data.archive_file.lambda_code"
          ]
        }
      ]
    },
    {
      "module": "module.lambda",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "stop_ec2",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-west-1:779846783544:function:automation-robot-stop-ec2",
            "code_sha256": "jd4B7QX7h5QWNlMjDBkLsA9rntJuZISZFF7ubXvg8gM=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "modules/lambda/lambda_function.zip",
            "function_name": "automation-robot-stop-ec2",
            "handler": "index.terminateInstance",
            "id": "automation-robot-stop-ec2",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:779846783544:function:automation-robot-stop-ec2/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-05-07T22:12:03.916+0000",
            "layers": null,
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/automation-robot-stop-ec2",
                "system_log_level": ""
              }
            ],
            "memory_size": 128,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-1:779846783544:function:automation-robot-stop-ec2:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:779846783544:function:automation-robot-stop-ec2:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::779846783544:role/automation-robot-lambda-role",
            "runtime": "nodejs16.x",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "jd4B7QX7h5QWNlMjDBkLsA9rntJuZISZFF7ubXvg8gM=",
            "source_code_size": 761,
            "tags": null,
            "tags_all": {
              "Environment": "dev",
              "ManagedBy": "Terraform",
              "Owner": "DevOps",
              "Project": "Automation-robot"
            },
            "timeout": 30,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.ec2.aws_launch_template.automation_template",
            "module.ec2.aws_security_group.automation_sg",
            "module.iam.aws_iam_policy.lambda_ec2_policy",
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.aws_iam_role_policy_attachment.lambda_ec2_attachment",
            "module.lambda.data.archive_file.lambda_code"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
